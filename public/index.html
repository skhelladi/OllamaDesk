<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OllamaDesk</title>
    <link rel="stylesheet" href="format.css">

    <!-- Add Highlight.js CSS and JS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css"
        rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/cpp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/latex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>

    <!-- Add marked.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>

    <!-- Add CryptoJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            hljs.highlightAll();
        });
    </script>

    <!-- Copy icon SVG -->
    <svg style="display: none;">
        <symbol id="copy-icon" viewBox="0 0 24 24">
            <path
                d="M16 1H4C3 1 2 2 2 3v14h2V3h12V1zm3 4H8C7 5 6 6 6 7v14c0 1 1 2 2 2h11c1 0 2-1 2-2V7c0-1-1-2-2-2zm0 16H8V7h11v14z" />
        </symbol>
        <symbol id="stop-icon" viewBox="0 0 24 24">
            <path d="M6 6h12v12H6z" />
        </symbol>
        <symbol id="retry-icon" viewBox="0 0 24 24">
            <path
                d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" />
        </symbol>
        <symbol id="send-icon" viewBox="0 0 24 24">
            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
        </symbol>
        <symbol id="edit-icon" viewBox="0 0 24 24">
            <path
                d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
        </symbol>
        <symbol id="save-icon" viewBox="0 0 24 24">
            <path
                d="M17 3H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3-1.34 3-3 3zm3-10H8V5h7v4z" />
        </symbol>
        <symbol id="about-icon" viewBox="0 0 24 24">
            <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm1.07-7.75l-.9.92C12.45 12.9 12 13.5 12 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.27c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z" />
        </symbol>
        <symbol id="settings-icon" viewBox="0 0 24 24">
            <path d="M19.14,12.94a7.07,7.07,0,0,0,.05-1,.78.78,0,0,0-.05-.88l2.11-1.65a.5.5,0,0,0,.12-.66l-2-3.46a.5.5,0,0,0-.61-.18l-2.49,1a7.12,7.12,0,0,0-1.68-.98l-.38-2.65A.5.5,0,0,0,14.5,3H9.5a.5.5,0,0,0-.5.43L8.62,6.08a7.12,7.12,0,0,0-1.68.98l-2.49-1a.5.5,0,0,0-.61.18l-2,3.46a.5.5,0,0,0,.12.66l2.11,1.65a7.07,7.07,0,0,0-.05,1,7.07,7.07,0,0,0,.05,1L2.44,14.59a.5.5,0,0,0-.12.66l2,3.46a.5.5,0,0,0,.61.18l2.49-1a7.12,7.12,0,0,0,1.68.98l.38,2.65a.5.5,0,0,0,.5.43h5a.5.5,0,0,0,.5-.43l.38-2.65a7.12,7.12,0,0,0,1.68-.98l2.49,1a.5.5,0,0,0,.61-.18l2-3.46a.5.5,0,0,0-.12-.66ZM12,15.5A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/>
        </symbol>
        <symbol id="loading-icon" viewBox="0 0 24 24">
            <path d="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"/>
        </symbol>
        <symbol id="light-mode-icon" viewBox="0 0 24 24">
            <path d="M12 4.5C12.83 4.5 13.5 3.83 13.5 3S12.83 1.5 12 1.5 10.5 2.17 10.5 3 11.17 4.5 12 4.5zM4.5 12C4.5 11.17 3.83 10.5 3 10.5S1.5 11.17 1.5 12 2.17 13.5 3 13.5 4.5 12.83 4.5 12zM12 19.5C12.83 19.5 13.5 18.83 13.5 18S12.83 16.5 12 16.5 10.5 17.17 10.5 18 11.17 19.5 12 19.5zM19.5 12C19.5 11.17 18.83 10.5 18 10.5S16.5 11.17 16.5 12 17.17 13.5 18 13.5 19.5 12.83 19.5 12zM12 7.5C12.83 7.5 13.5 6.83 13.5 6S12.83 4.5 12 4.5 10.5 5.17 10.5 6 11.17 7.5 12 7.5zM12 15.5C12.83 15.5 13.5 14.83 13.5 14S12.83 12.5 12 12.5 10.5 13.17 10.5 14 11.17 15.5 12 15.5zM7.5 12C7.5 11.17 6.83 10.5 6 10.5S4.5 11.17 4.5 12 5.17 13.5 6 13.5 7.5 12.83 7.5 12zM16.5 12C16.5 11.17 15.83 10.5 15 10.5S13.5 11.17 13.5 12 14.17 13.5 15 13.5 16.5 12.83 16.5 12z"/>
        </symbol>
        <symbol id="dark-mode-icon" viewBox="0 0 24 24">
            <path d="M12 3C10.34 3 8.79 3.5 7.5 4.35 6.21 5.2 5.2 6.21 4.35 7.5 3.5 8.79 3 10.34 3 12s0.5 3.21 1.35 4.5c0.85 1.29 1.86 2.3 3.15 3.15C8.79 20.5 10.34 21 12 21s3.21-0.5 4.5-1.35c1.29-0.85 2.3-1.86 3.15-3.15C20.5 15.21 21 13.66 21 12s-0.5-3.21-1.35-4.5c-0.85-1.29-1.86-2.3-3.15-3.15C15.21 3.5 13.66 3 12 3zM12 19c-1.66 0-3.21-0.5-4.5-1.35-1.29-0.85-2.3-1.86-3.15-3.15C3.5 13.21 3 11.66 3 10s0.5-3.21 1.35-4.5c0.85-1.29 1.86-2.3 3.15-3.15C8.79 1.5 10.34 1 12 1s3.21 0.5 4.5 1.35c1.29 0.85 2.3 1.86 3.15 3.15C20.5 6.79 21 8.34 21 10s-0.5 3.21-1.35 4.5c-0.85 1.29-1.86 2.3-3.15 3.15C15.21 18.5 13.66 19 12 19z"/>
        </symbol>
        <symbol id="theme-toggle-icon" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"/>
            <path d="M12 4a8 8 0 0 0 0 16z"/>
        </symbol>
        <symbol id="trash-icon" viewBox="0 0 24 24">
            <path d="M3 6h18v2H3V6zm2 3h14v13H5V9zm3 2v9h2v-9H8zm4 0v9h2v-9h-2zm4 0v9h2v-9h-2z"/>
        </symbol>
        <symbol id="new-session-icon" viewBox="0 0 24 24">
            <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" />
        </symbol>
        <symbol id="show-sidebar-icon" viewBox="0 0 24 24">
            <path d="M3 3h18v2H3V3zm0 4h18v2H3V7zm0 4h18v2H3v-2zm0 4h18v2H3v-2zm0 4h18v2H3v-2z"/>
        </symbol>
        <symbol id="hide-sidebar-icon" viewBox="0 0 24 24">
            <path d="M3 3h18v2H3V3zm0 4h18v2H3V7zm0 4h18v2H3v-2zm0 4h18v2H3v-2zm0 4h18v2H3v-2z"/>
        </symbol>
    </svg>
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">
</head>

<body>
    <div class="app-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>Recents</h2>
                <!-- Update new session button with a new icon -->
                <button type="button" class="action-button new-session" id="new-session-button" title="New Session">
                    <svg>
                        <use href="#new-session-icon" />
                    </svg>
                </button>
                <!-- Add toggle sidebar button -->
                <button type="button" id="toggle-sidebar-button" title="Toggle Sidebar">
                    <svg>
                        <use href="#hide-sidebar-icon" />
                    </svg>
                </button>
            </div>
            <div class="history-list" id="history-list">
                <!-- History items will be added here dynamically -->
            </div>
        </div>
        <div class="container">
            <div class="header-container">
                <div class="header-left">
                    <h1>OllamaDesk</h1>
                </div>
                <div class="header-right">
                    <div class="model-selector">
                        <label for="model-select">Model:</label>
                        <select id="model-select"></select>
                    </div>
                    <!-- About Button -->
                    <button type="button" class="action-button about" id="about-button" title="About">
                        <svg>
                            <use href="#about-icon" />
                        </svg>
                    </button>
                    <!-- Add Settings Button -->
                    <button type="button" class="action-button settings" id="settings-button" title="Settings">
                        <svg>
                            <use href="#settings-icon" />
                        </svg>
                    </button>
                    <!-- Add Theme Toggle Button -->
                    <button type="button" class="action-button theme-toggle" id="theme-toggle-button" title="Toggle Theme">
                        <svg>
                            <use href="#theme-toggle-icon" />
                        </svg>
                    </button>
                </div>
            </div>
            <div class="chat-container" id="reponse"></div>
            <div class="input-container">
                <form class="input-group">
                    <div class="input-wrapper">
                        <div id="loading-indicator" class="loading-indicator" style="display: none;">
                            <svg><use href="#loading-icon"/></svg>
                        </div>
                        <input type="text" id="chat" placeholder="   Your message...">
                    </div>
                </form>
                <div class="input-actions">
                    <button type="submit" class="action-button send" id="send-button" title="Send">
                        <svg>
                            <use href="#send-icon" />
                        </svg>
                    </button>
                    <button type="button" class="action-button stop" id="stop-button" title="Stop" disabled>
                        <svg>
                            <use href="#stop-icon" />
                        </svg>
                    </button>
                    <button type="button" class="action-button retry" id="retry-button" title="Retry" disabled>
                        <svg>
                            <use href="#retry-icon" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add About Modal HTML -->
    <div class="stacked-widget-container" id="about-modal">
        <div class="retry-page">
            <h2>About This Application</h2>
            <p>This application serves as an AI assistant, allowing users to interact with various models to obtain
                solutions to their queries.
                This code is a graphical interface for <a href="https://ollama.com/" target="_blank">Ollama</a> using
                free LLMs.
                The backend server is responsible for model management and processing.</p>

            <p class="footer-text"><strong>Author:</strong> Sofiane KHELLADI &lt;sofiane@khelladi.page&gt;</p>
            <p class="footer-text"><strong>License:</strong> GPL</p>
            <br />
            <br />
            <p class="footer-text">&copy; 2024 Sofiane KHELLADI. All rights reserved.</p>
            <button type="button" class="pagination-button" id="close-about">Close</button>
        </div>
    </div>

    <!-- Add Settings Modal HTML -->
    <div class="stacked-widget-container" id="settings-modal">
        <div class="retry-page" style="max-width: 600px; font-size: 1.2rem;">
            <h2>Settings</h2>
            <form id="settings-form">
                <div class="form-group">
                    <label for="stream">Stream:</label>
                    <select id="stream" name="stream">
                        <option value="true">True</option>
                        <option value="false">False</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="temperature">Temperature:</label>
                    <input type="number" id="temperature" name="temperature" min="0" max="1" step="0.1" value="0.7">
                </div>

                <!-- Change label from "System Content" to "Context" -->
                <div class="form-group">
                    <label for="systemContent">Context:</label>
                    <textarea id="systemContent" name="systemContent" rows="4">You are a helpful AI assistant, always respond in the same language as the user. Always add a title to your messages if the question is about a specific topic. Write all the equations in LaTeX format.</textarea>
                </div>

                <!-- Add input field for port number -->
                <div class="form-group">
                    <label for="port">Port:</label>
                    <input type="number" id="port" name="port" min="1" max="65535" value="3333">
                </div>

                <!-- Wrap buttons in a container for inline alignment -->
                <div class="button-group" style="justify-content: center;">
                    <button type="submit" class="pagination-button">Save</button>
                    <button type="button" class="pagination-button" id="close-settings">Cancel</button>
                    <button type="button" class="pagination-button" id="reset-settings">Reset to Default</button>
                </div>
            </form>
        </div>
    </div>

    <script src="./index.js"></script>
</body>

</html>